<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title> Form</title>
</head>

<body>
    <form name="formulario" action="#" method="GET">
        Empresa: <input type="text" id="empresa" name="empresa">
        <br/> Cargo <input type="text" id="cargo" name="cargo">
        <br/> Fecha inicio: <input type="date" id="fechaInicio" name="fechaInicio">
        <br/> Fecha fin: <input type="date" id="fechaFin" name="fechaFin">
        <br/> Localizacion: <input type="text" id="localizacion" name="localizacion">
        <input type="button" value="AÃ±adir" onclick="anhadir()">

        <br/> JSON: <br/>
        <textarea id="json" rows="5" cols="40"></textarea>
        <br/><input type="button" value="Cargar" onclick="cargar()">
        <input type="button" value="Cargar localStorage" onclick="cargarLocalStorage()">

    </form>

    <div id="experiencias"></div>

</body>

<script type="text/javascript">
    var experiencias = new Array();
    var storage = localStorage;

    window.onload = function() {
        if (storage.getItem(1) == null) {
            return;
        } else {
            var datosAlmacenados = storage.getItem(1);
            document.getElementById("json").value = datosAlmacenados;
            var datosLeidos = JSON.parse(datosAlmacenados);
            experiencias = datosLeidos;
            var cadena = "<table><tr>Empresa<th>Cargo</th><th>Fecha inicio</th><th>Fecha Fin</th><th>Localizacion</th></tr><tr>";
            for (var i = 0; i < datosLeidos.length; i++) {
                cadena += "<td>" + datosLeidos[i].empresa + "</td><td>" + datosLeidos[i].cargo + "</td><td>" + datosLeidos[i].fechaI + "</td><td>" + datosLeidos[i].fechaF + "</td><td>" + datosLeidos[i].localizacion + " </td></tr>"
            }
            cadena += "</table>"
            document.getElementById("experiencias").innerHTML += cadena;
        }
    }

    function anhadir() {
        var experiencia = new Object();
        experiencia.empresa = document.getElementById("empresa").value;
        experiencia.cargo = document.getElementById("cargo").value;
        experiencia.fechaI = document.getElementById("fechaInicio").value;
        experiencia.fechaF = document.getElementById("fechaFin").value;
        experiencia.localizacion = document.getElementById("localizacion").value;

        experiencias.push(experiencia);
        var datosJson = JSON.stringify(experiencias);
        document.getElementById("json").value = datosJson;
        storage.setItem("1", datosJson);
    }


    function cargar() {
        var texto = document.getElementById("json").value;
        var datosLeidos = JSON.parse(texto);
        var cadena = "<table><tr>Empresa<th>Cargo</th><th>Fecha inicio</th><th>Fecha Fin</th><th>Localizacion</th></tr><tr>";
        for (var i = 0; i < datosLeidos.length; i++) {
            cadena += "<td>" + datosLeidos[i].empresa + "</td><td>" + datosLeidos[i].cargo + "</td><td>" + datosLeidos[i].fechaI + "</td><td>" + datosLeidos[i].fechaF + "</td><td>" + datosLeidos[i].localizacion + " </td></tr>"
        }
        cadena += "</table>"
        document.getElementById("experiencias").innerHTML += cadena;
    }

    function cargarLocalStorage() {
        var datosAlmacenados = storage.getItem(1);
        document.getElementById("json").value = datosAlmacenados;
        var datosLeidos = JSON.parse(datosAlmacenados);
        var cadena = "<table><tr>Empresa<th>Cargo</th><th>Fecha inicio</th><th>Fecha Fin</th><th>Localizacion</th></tr><tr>";
        for (var i = 0; i < datosLeidos.length; i++) {
            cadena += "<td>" + datosLeidos[i].empresa + "</td><td>" + datosLeidos[i].cargo + "</td><td>" + datosLeidos[i].fechaI + "</td><td>" + datosLeidos[i].fechaF + "</td><td>" + datosLeidos[i].localizacion + " </td></tr>"
        }
        cadena += "</table>"
        document.getElementById("experiencias").innerHTML += cadena;
    }
</script>

</html>